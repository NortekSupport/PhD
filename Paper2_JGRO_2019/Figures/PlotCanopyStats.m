%Plot canopy statistics for Paper 2. a, n, d and phi by z. 
clear
load('f:\Mekong_W2015\DataAnalysis\DataReports\Vegetation\2015\Q2A_HTAss.mat')
Q2a = vegdat;
load('f:\Mekong_W2015\DataAnalysis\DataReports\Vegetation\2015\Q4_VTAss.mat')
Q4 = vegdat;clear vegdat
load('f:\Mekong_W2015\DataAnalysis\DataReports\Vegetation\Vegdat_14_15_1m.mat')

zid = find(Q2a.n == 0,1,'first');
Q2a.n(zid:end) = 1;
Q2a.d(zid:end) = fastsmooth(data.y15.Q2A.dmean(zid:end),3,1,1)./5;
Q2an = fastsmooth(Q2a.n./Q2a.area,5,1,1);
Q4n = fastsmooth(Q4.n./Q4.area,5,1,1);


f1 = figure(1);
set(f1,'PaperOrientation','portrait',...
    'position',[400 100   1000   400]);
set(gcf,'color','w','paperpositionmode','auto')
lines = {'-','-','-','-'};
cmap = csvread('g:\GradSchool\Design\Qualitative8_4.csv');
c= flipud(cmap)./255;
sp(1) = subplot(141);
plot(data.y15.Q2A.N,data.y15.Q2A.z./0.64,lines{1},...
    'color',c(1,:),...
    'linewidth',2),hold on
plot(data.y15.Q4.N,data.y15.Q4.z./0.6,lines{2},...
    'color',c(2,:),...
    'linewidth',2)
plot(Q2an,Q2a.z./0.64,lines{3},...
    'color',c(3,:),...
    'linewidth',2)
plot(Q4n,Q4.z./0.6,lines{4},...
    'color',c(4,:),...
    'linewidth',2)
plot(linspace(0,250,10),ones(1,10),'-k',...
    'linewidth',1.5)
plot(linspace(0,250,10),ones(1,10)*0.33,'--k',...
    'linewidth',1.5)
plot(linspace(0,250,10),ones(1,10)*0.23,':k',...
    'linewidth',1.5)
sp(2) = subplot(142);
plot(data.y15.Q2A.dmean,data.y15.Q2A.z./0.64,lines{1},...
    'color',c(1,:),...
    'linewidth',2),hold on
plot(data.y15.Q4.dmean,data.y15.Q4.z./0.6,lines{2},...
    'color',c(2,:),...
    'linewidth',2)
plot(Q2a.d,Q2a.z./0.64,lines{3},...
    'color',c(3,:),...
    'linewidth',2)
plot(Q4.d,Q4.z./0.6,lines{4},...
    'color',c(4,:),...
    'linewidth',2)
plot(linspace(0,0.04,10),ones(1,10),'-k',...
    'linewidth',1.5)
plot(linspace(0,0.04,10),ones(1,10)*0.33,'--k',...
    'linewidth',1.5)
plot(linspace(0,0.04,10),ones(1,10)*0.23,':k',...
    'linewidth',1.5)
sp(3) = subplot(143);
plot(data.y15.Q2A.a,data.y15.Q2A.z./0.64,lines{1},...
    'color',c(1,:),...
    'linewidth',2),hold on
plot(data.y15.Q4.a,data.y15.Q4.z./0.6,lines{2},...
    'color',c(2,:),...
    'linewidth',2)
plot(fastsmooth((Q2a.n./Q2a.area).*Q2a.d,2,1,1),Q2a.z./0.64,lines{3},...
    'color',c(3,:),...
    'linewidth',2)
plot(fastsmooth((Q4.n./Q4.area).*Q4.d,2,1,1),Q4.z./0.6,lines{4},...
    'color',c(4,:),...
    'linewidth',2)
plot(linspace(0,5,10),ones(1,10),'-k',...
    'linewidth',1.5)
plot(linspace(0,5,10),ones(1,10)*0.33,'--k',...
    'linewidth',1.5)
plot(linspace(0,5,10),ones(1,10)*0.23,':k',...
    'linewidth',1.5)
sp(4) = subplot(144);
p(1) = plot(data.y15.Q2A.phi,data.y15.Q2A.z./0.64,lines{1},...
    'color',c(1,:),...
    'linewidth',2);hold on
p(2) = plot(data.y15.Q4.phi,data.y15.Q4.z./0.6,lines{2},...
    'color',c(2,:),...
    'linewidth',2);
p(3) = plot(fastsmooth(Q2a.phi,2,1,1),Q2a.z./0.64,lines{3},...
    'color',c(3,:),...
    'linewidth',2);
p(4) = plot(fastsmooth(Q4.phi,2,1,1),Q4.z./0.6,lines{4},...
    'color',c(4,:),...
    'linewidth',2);
plot(linspace(0,0.1,10),ones(1,10),'-k',...
    'linewidth',1.5)
plot(linspace(0,0.1,10),ones(1,10)*0.33,'--k',...
    'linewidth',1.5)
plot(linspace(0,0.1,10),ones(1,10)*0.23,':k',...
    'linewidth',1.5)
%%%Global plot adjustments
leg = legend(p,{'HTA - 1 m^2';'VTA - 1 m^2';'HTA - 0.2 m^2';'VTA - 0.2 m^2'});
set(leg,'position',[0.84 0.65 0.15 0.05])
set(sp,'ytick',0:0.2:1.2,'ylim',[0 1.2])
set(sp(1),'xlim',[0 250])
set([sp(2) sp(3) sp(4)],'yticklabel',[])
set(sp(1),'position',[0.11 0.17 0.18 0.75])
set(sp(2),'position',[0.33 0.17 0.18 0.75])
set(sp(3),'position',[0.55 0.17 0.18 0.75],...
    'xtick',0:2.5:5,'xlim',[0 5])
set(sp(4),'position',[0.77 0.17 0.18 0.75])
ylabel(sp(1),'\itz/h_{max} (m)')
xlabel(sp(1),'\itn (m^{-2})')
xlabel(sp(2),'d (m)')
xlabel(sp(3),'\ita (m^{-1})')
xlabel(sp(4),'\it\phi (-)')
prettyfigures('text',13,'labels',14,'box',1)
savefigdir = 'd:\Projects\Documents\Writing\JGR_2018_Norris\Figures\Draft2_Figures\V8\';
export_fig([savefigdir 'Figure6'],'-pdf')